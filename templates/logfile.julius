var url = document.URL,
    output = document.getElementById("output"),
    conn,
    p = document.getElementById("log"),

url = url.replace("http:", "ws:").replace("https:", "wss:");
conn = new WebSocket(url);
output.appendChild(p);

conn.onmessage = function(e) {
    var msg = JSON.parse(e.data)
    if(msg.type == "Data"){
	var lines = msg.contents.split("\n"),
            line;
	for (var i = 0; i < lines.length; i++){
    	    line = lines[i];
    	    if(line.length > 0){
    		p.appendChild(document.createTextNode(line));
    		p.appendChild(document.createElement("br"));
    	    }
	}
    }
};

output.addEventListener("submit", function(e){
    e.preventDefault();
});
